# AI-ChatBot

これは、シンプルなFAQ応答を行うAIチャットボットのプロジェクトです。Flaskをバックエンドサーバーとして使用し、フロントエンドとAPIで通信します。ユーザーの質問の意図を理解するために、事前学習済みの日本語言語モデル（Sentence Transformers）を利用しています。

## ✨ 特徴

-   **セマンティック検索**: ユーザーの質問を単語の完全一致ではなく、文章の「意味」で捉えて最適な回答を検索します。
-   **簡単なナレッジ更新**: `data/faq.json` を編集するだけで、チャットボットの応答内容を簡単に追加・変更できます。
-   **シンプルな構成**: PythonとFlaskをベースにしており、動作原理が理解しやすいシンプルな構成です。
-   **Webインターフェース**: `public` ディレクトリに含まれるHTML/CSS/JavaScriptにより、ブラウザ上でチャットを試すことができます。

## ⚙️ 動作要件

このプログラムを実行するには、Python 3.8以上が必要です。
必要なライブラリは `requirements.txt` に記載されています。

-   Flask
-   Flask-Cors
-   sentence-transformers
-   numpy
-   fugashi
-   ipadic
-   unidic-lite

## 🚀 セットアップと実行方法

1.  **リポジトリをクローンします**
    ```bash
    git clone <your-repository-url>
    cd AI-ChatBot
    ```

2.  **必要なライブラリをインストールします**
    仮想環境を作成し、その中でライブラリをインストールすることを推奨します。
    ```bash
    # 仮想環境の作成 (Windows)
    python -m venv venv
    # 仮想環境のアクティベート (Windows)
    .\venv\Scripts\activate
    
    # 必要なライブラリをインストール
    pip install -r requirements.txt
    ```
    *初回実行時、`sentence-transformers` がモデル（`cl-tohoku/bert-base-japanese-whole-word-masking`）を自動的にダウンロードするため、インターネット接続が必要です。*

3.  **アプリケーションを起動します**
    ```bash
    python src/app.py
    ```

4.  **ブラウザでアクセスします**
    Webブラウザを開き、以下のURLにアクセスしてください。
    http://127.0.0.1:5000/

## 📝 FAQのカスタマイズ方法

チャットボットの応答内容は `data/faq.json` ファイルで管理されています。このファイルを編集することで、独自のFAQチャットボットを作成できます。

### 構造

JSONファイルは、オブジェクトの配列で構成されています。各オブジェクトは1つの「回答」に対応します。

-   `questions`: ユーザーからの質問として想定される文章のリスト（配列）。ここに多くのバリエーションを記述することで、回答精度が向上します。
-   `answer`: `questions` のいずれかにマッチしたときに返す回答文。

```json
{
  "questions": [
    "質問のバリエーション1",
    "質問のバリエーション2"
  ],
  "answer": "ここに回答文を記述します。"
}
```

ファイルを変更した後は、アプリケーションを再起動すると変更が反映されます。

### 補足: 回答を導き出す仕組み

このチャットボットは、以下のステップでユーザーの質問に最も近い回答を見つけ出しています。

1.  **ベクトル化**: アプリケーション起動時に、`faq.json` に書かれた全ての質問文を、AIモデル（BERTベース）を使って768次元のベクトルに変換しておきます。このベクトルは、文章の「意味」を数値で表現したものです。

2.  **ユーザー入力のベクトル化**: ユーザーから受け取った質問文も、同様に768次元のベクトルに変換します。

3.  **コサイン類似度の計算**: ユーザーの質問ベクトルと、事前に用意しておいたFAQの全質問ベクトルの「向き」がどれだけ似ているかを、**コサイン類似度**を用いて計算します。
    -   **なぜコサイン類似度？**: 文章の長さ（単語数）に影響されず、純粋に「意味の方向性」だけを比較できるためです。
    -   コサイン類似度は`-1`から`1`の範囲の値を取ります。2つのベクトルの向きが完全に同じ場合は`1`（意味が非常に近い）、直交する場合は`0`、正反対の場合は`-1`となります。

4.  **回答の選択**: 計算した類似度が最も高く、かつ設定した閾値（例: `0.6`）を超えた質問に対応する回答を、ボットの返信として選択します。

#### イメージ

768次元という高次元空間は想像が難しいですが、コサイン類似度の計算はもっとシンプルに捉えられます。

比較したい2つのベクトル（例: ユーザーの質問とFAQの質問）は、原点と合わせて必ず**1枚の平面**を形作ります。コサイン類似度は、この平面上で2つのベクトルのなす角度を測っているのと同じです。

つまり、どんなに高次元であっても、比較の瞬間は常に2次元の平面上で行われているため、純粋な「意味の方向性」の比較が可能になるのです。
